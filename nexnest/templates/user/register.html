{% extends "base.html" %}
{% block content %}
    <meta id="schools" data-name="schools" data-other="{{schools}}">
    <br>
    <div class="row m-x-auto">
        <div class="col-xs-1 col-sm-2 col-md-2 col-lg-2 col-xl-4">
        </div>
        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8 col-xl-4">
            <div class="row">
                <div class="card" style="width:100%;">
                    <h3 class="card-header">Sign Up for NexNest</h3>
                    <div class="card-block">
        				{% from "_formhelpers.html" import render_field %}
        				<form id="registerForm" action="{{url_for('users.register')}}" method="POST">
        					{{form.csrf_token}}
                            <div class="btn-group" data-toggle="buttons" style="display: flex;">
                                <label class="btn btn-outline-primary active" id="registerAsTenant">
                                    <input type="radio" checked autocomplete="off"> <i class="fa fa-graduation-cap" aria-hidden="true"></i> Tenant
                                </label>
                                <label class="btn btn-outline-primary" id="registerAsLandlord">
                                    <input type="radio" autocomplete="off"><i class="fa fa-home" aria-hidden="true"></i>  Landlord
                                </label>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">First Name</label>
                                        {{form.fname(class='form-control', required='required')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Last Name</label>
                                        {{form.lname(class='form-control', required='required')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="collegeField">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">College</label>
                                        {{form.school(class='form-control')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Email</label>
                                        {{form.email(class='form-control', required='required', type="email")}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Password</label>
                                        {{form.password(class='form-control', required='required', type="password")}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Confirm Password</label>
                                        {{form.confirm(class='form-control', required='required', type="password")}}
                                    </div>
                                </div>
                            </div>
                            {{form.landlord}}
						  	<p>
						  		<button id="submitRegistration" type="button" style="float: right;" class="btn btn-primary" onClick="submitForm()">Register As Tenant</button>
						  	</p>
        				</form>            
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
<script>
$("#registerAsLandlord").change(function () {
    $("#collegeField").hide();
    $('#school').removeAttr('required');
    var $el = $("#school");
    $el.empty(); // remove old options
    $("#landlord").val("landlord");
    $("#submitRegistration").text("Register as Landlord");
});

$("#registerAsTenant").change(function () {
    $("#collegeField").show();
    $('#school').attr('required', 'required');
    var $el = $("#school");
    $el.empty(); // remove old options
    var newOptions = {
      {% for school in schools %}
        '{{school}}': '{{school}}',
      {% endfor %}
    };
    $.each(newOptions, function(key,value) {
        $el.append($("<option></option>")
     .attr("value", value).text(key));
    });
    $("#landlord").val("tenant");
    $("#submitRegistration").text("Register as Tenant");
});

$( document ).ready(function() {
    var newOptions = {
      {% for school in schools %}
        '{{school}}': '{{school}}',
      {% endfor %}
    };

      check = $("#registerAsLandlord").hasClass("active");
      if(check) {
          $("#collegeField").hide();
          $('#school').removeAttr('required');
          $("#landlord").val("landlord");
          $("#submitRegistration").text("Register as Landlord");
      } else {
          $("#collegeField").show();
          $('#school').attr('required', 'required');
          var $el = $("#school");
          $el.empty(); // remove old options
          var newOptions = {
            {% for school in schools %}
              '{{school}}': '{{school}}',
            {% endfor %}
          };
          $.each(newOptions, function(key,value) {
              $el.append($("<option></option>")
           .attr("value", value).text(key));
          });
          $("#landlord").val("tenant");
          $("#submitRegistration").text("Register as Tenant");
      }
});

function submitForm(){
    check = $("#registerAsLandlord").hasClass("active");
    if(check) {
        $("#landlord").val("landlord");
    } else {
        $("#landlord").val("tenant");
    }
    $("form#registerForm").submit();
}

</script>
{% endblock %}
