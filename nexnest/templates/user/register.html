{% extends "base.html" %}
{% block content %}
    <meta id="schools" data-name="schools" data-other="{{schools}}">
    <br>
    <div class="row m-x-auto">
        <div class="col-xs-1 col-sm-2 col-md-2 col-lg-2 col-xl-4">
        </div>
        <div class="col-xs-10 col-sm-8 col-md-8 col-lg-8 col-xl-4">
            <div class="row">
                <div class="card" style="width:100%;">
                    <h3 class="card-header">Register for NexNest</h3>
                    <div class="card-block">
        				{% from "_formhelpers.html" import render_field %}
        				<form id="registerForm" action="{{url_for('users.register')}}" method="POST">
        					{{form.csrf_token}}
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="funkyradio">
                                        <div class="funkyradio-primary">
                                            <input type="checkbox" name="checkbox" id="landlordRegister"/>
                                            <label for="landlordRegister">Register as Landlord/Property Owner</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Email</label>
                                        {{form.email(class='form-control', required='required', type="email")}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">First Name</label>
                                        {{form.fname(class='form-control', required='required')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Last Name</label>
                                        {{form.lname(class='form-control', required='required')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="collegeField">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">College</label>
                                        {{form.school(class='form-control')}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Password</label>
                                        {{form.password(class='form-control', required='required', type="password")}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Confirm Password</label>
                                        {{form.confirm(class='form-control', required='required', type="password")}}
                                    </div>
                                </div>
                            </div>
                            {{form.landlord}}
						  	<p>
						  		<button type="button" class="btn btn-primary" onClick="submitForm()">Register</button>
						  	</p>
        				</form>            
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
<script>
$("#landlordRegister").change(function () {
    check = $("#landlordRegister").prop("checked");
    if(check) {
        $("#collegeField").hide();
        $('#school').removeAttr('required');
        var $el = $("#school");
        $el.empty(); // remove old options
        $("#landlord").val("landlord");
    } else {
        $("#collegeField").show();
        $('#school').attr('required', 'required');
        var $el = $("#school");
        $el.empty(); // remove old options
        var newOptions = {
          {% for school in schools %}
            '{{school}}': '{{school}}',
          {% endfor %}
        };
        $.each(newOptions, function(key,value) {
            $el.append($("<option></option>")
         .attr("value", value).text(key));
        });
        $("#landlord").val("tenant");
    }
});

$( document ).ready(function() {
    var newOptions = {
      {% for school in schools %}
        '{{school}}': '{{school}}',
      {% endfor %}
    };

    var $el = $("#school");
    $el.empty(); // remove old options
    $.each(newOptions, function(key,value) {
      $el.append($("<option></option>")
         .attr("value", value).text(key));
    });
});

function submitForm(){
    check = $("#landlordRegister").prop("checked");
    if(check) {
        $("#landlord").val("landlord");
    } else {
        $("#landlord").val("tenant");
    }
    alert($("#landlord").val());
    $("form#registerForm").submit();
}

</script>
{% endblock %}
