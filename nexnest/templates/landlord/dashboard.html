{% extends 'base.html' %}
{% block content %}
<!-- {
{% if requestedTours %}
    <h1>Requested Tours</h1>
    {% for tourObject in requestedTours %}
        <strong>{{tourObject.listing}}</strong><br>
        {% for tour in tourObject.tours %}
            {{tour}}<br>
        {% endfor %}
        <hr>
    {% endfor %}
{% endif %}

{% if scheduledTours %}
    <h1>Suggested Tours</h1>
    {% for tourObject in scheduledTours %}
        <strong>{{tourObject.listing}}</strong><br>
        {% for tour in tourObject.tours %}
            {{tour}}<br>
        {% endfor %}
        <hr>
    {% endfor %}
{% endif %}

{% if unAcceptedHousingRequests %}
    <h1>Unaccepted Housing Requests</h1>
    {% for housingRequestObject in unAcceptedHousingRequests %}
        <strong>{{housingRequestObject.listing}}</strong><br>
        {% for housingRequest in housingRequestObject.houseRequests %}
            {{housingRequest}}<br>
        {% endfor %}
        <hr>
    {% endfor %}
{% endif %}
<hr>
{% if acceptedHousingRequests %}
    <h1>Accepted Housing Requests</h1>
    {% for housingRequest in acceptedHousingRequests %}
        {{housingRequest}}<br>
    {% endfor %}
{% endif %}
<hr>
{% if completedHousingRequests %}
    <h1>Completed Housing Requests</h1>
    {% for housingRequest in completedHousingRequests %}
        {{housingRequest}}<br>
    {% endfor %}
{% endif %}
<hr>

<hr>
{% if openMaintenanceRequests %}
    <h1>Maintenance Requests</h1>
    {% for maintenanceRequestObject in openMaintenanceRequests %}
        <strong>{{maintenanceRequestObject.house.listing.street}}</strong><br>
        {% for maintenanceRequest in maintenanceRequestObject.maintenanceRequests %}
            {{maintenanceRequest}}<br>
        {% endfor %}
    {% endfor %}
{% endif %}-->


<link href="{{url_for('static', filename='css/landlord/dashboardStyling.css')}}" rel="stylesheet">
<div class="row">
    <div class="col-md-2 col-sm-1 hidden-xs display-table-cell v-align box" id="navigation" style="height: inherit;">
        <div class="navi navbar">
        	<ul>
        		<li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#" role="tab" style="pointer-events: none;">
                        </i><h4 class="hidden-xs hidden-sm"><strong>My Dashboard</strong></h4>
                    </a>
                </li>
        		<li class="nav-item">
        	        <a class="nav-link active" data-toggle="tab" href="#occupiedListingsTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Occupied Listings</span>
        	        </a>
        	    </li>
        	    <li class="nav-item">
        	        <a class="nav-link" data-toggle="tab" href="#unbookedListingsTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Unbooked Listings</span>
        	        </a>
        	    </li>
        	    <li class="nav-item">
        	        <a class="nav-link" data-toggle="tab" href="#toursTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Tours</span>
        	        </a>
        	    </li>
        	    <li class="nav-item">
        	        <a class="nav-link" data-toggle="tab" href="#requestsTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Listing Requests</span>
        	        </a>
        	    </li>
        	    <li class="nav-item">
        	        <a class="nav-link" data-toggle="tab" href="#maintenanceTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Maintenance Requests</span>
        	        </a>
        	    </li>
        	    <li class="nav-item">
        	        <a class="nav-link" data-toggle="tab" href="#paymentTab" role="tab">
        	        	<i class="fa fa-tasks" aria-hidden="true"></i><span class="hidden-xs hidden-sm">Payment Portal</span>
        	        </a>
        	    </li>
        	</ul>
        </div>
    </div>
    <div class="col-sm-11 col-md-10">
	    <div class="tab-content">
		    <div class="tab-pane active" id="occupiedListingsTab" role="tabpanel" style="padding: 0px;">
		    	<div class="row">
			    	<div class="col-xs-1"></div>
			    	<div class="col-xs-10">
				    	<div class="callout-block text-center fade-in-b">
				    		<h1>Occupied Listings</h1>
				    	</div>
			    	</div>
			    </div>
		    	<br>
		    	{% if houses %}
		    	    {% for house in houses %}
		    	        <div class="row">
			            		<div class="col-xs-1"></div>
			            		<div class="col-xs-10" style="width: 100%">
					                <div class="card">
					                    <div class="card-header">
						                    <div class="row">
						                    	<div class="col-xs-10">
						                    		<a href="{{ url_for('houses.view', id=house.listing.id) }}">
						                    			<h3><strong>{{ house.listing.street }}, {{ house.listing.city }} {{ house.listing.state }}</strong></h3>
						                    			<small>Lease Period: {{ house.listing.start_date }} - {{ house.listing.end_date }}</small>
						                    		</a>
						                    	</div>
						                    </div>			                    
					                    </div>
					                    <div class="card-block">
						                    <div class="row">
						                    	<div class="col-xs-4">
						                    		<img src="{{url_for('static', filename='img/testHouse.jpg')}}" class="listingImg">
						                    	</div>
						                    	<div class="col-xs-8">
						                    		<h3><strong style="color:green;"><i class="fa fa-usd" aria-hidden="true"></i>{{ house.listing.price }}</strong> per bedroom per semester</h3>
						                    		<h3><strong>{{ house.listing.num_bedrooms }}<i class="fa fa-bed" aria-hidden="true"></i>
						                    		&nbsp;
						                    		{{ house.listing.num_full_baths }}<i class="fa fa-bath" aria-hidden="true"></i></strong></h3>
						                    		<br>
						                    		<h3><strong>Occupied By: {{house.group.name}}</strong>({{house.group.acceptedUsers|count}} Members)</h3>
						                    		<strong>Group Leader:</strong>
						                    		{% for user in house.group.acceptedUsers %}
						                    			{% with group=house.group %}         
						                    				<div class="row">
						                    					<div class="col-xs-8">
						                    						{% if group.leader_id == user.id %}
						                    		    				{% include 'landlord/smallMember.html' %}
						                    						{% endif %}
						                    		    		</div>
						                    		    	</div>
						                    		    {% endwith %}
						                    		{% endfor %}
    			      					    		<div id="allGroupMembers{{house.group.id}}" style="display: none;">
    		      					    				{% for user in house.group.acceptedUsers %}
    		      					    					{% with group=house.group %}         
    		      					    						<div class="row">
    		      					    							<div class="col-xs-8">
    		      					    								{% if not group.leader_id == user.id %}
    		      					    				    				{% include 'landlord/smallMember.html' %}
    		      					    				    			{% endif %}
    		      					    				    		</div>
    		      					    				    	</div>
    		      					    				    {% endwith %}
    		      					    				{% endfor %}
    			      					    		</div>
    			      					    		<button class="btn btn-info" id="allGroupMembersToggle{{house.group.id}}"><i class='fa fa-users' aria-hidden='true'></i> See other {{house.group.acceptedUsers|count-1}} members</button>
    			      					    		<button class="btn btn-info" id="hideAllGroupMembersToggle{{house.group.id}}" style="display: none;"><i class='fa fa-users' aria-hidden='true'></i> Hide other {{house.group.acceptedUsers|count-1}} members</button>

    			      					    		<script type="text/javascript">
    			      					    			//Show/hide members of group
    			      					    			$("#allGroupMembersToggle{{house.group.id}}").click(function(){
    			      					    			    $("#allGroupMembers{{house.group.id}}").toggle();
    			      					    			    $("#allGroupMembersToggle{{house.group.id}}").hide();
    			      					    			    $("#hideAllGroupMembersToggle{{house.group.id}}").show();   	
    			      					    			});

    			      					    			$("#hideAllGroupMembersToggle{{house.group.id}}").click(function(){
    			      					    			    $("#allGroupMembers{{house.group.id}}").toggle();
    			      					    			    $("#allGroupMembersToggle{{house.group.id}}").show();
    			      					    			    $("#hideAllGroupMembersToggle{{house.group.id}}").hide();   	
    			      					    			});
    			      					    		</script>
						                    		<br>
						                    	</div>
						                    </div>
					                    </div>
					                </div>
				                </div>
			                </div>
		    	    {% endfor %}
		    	{% else %}
		    		No House For you	
		    	{% endif %}
		    </div>
	        <div class="tab-pane" id="unbookedListingsTab" role="tabpanel" style="padding: 0px;">
	        	<div class="row">
			    	<div class="col-xs-1"></div>
			    	<div class="col-xs-10">
				    	<div class="callout-block text-center fade-in-b">
				    		<h1>Unbooked Listings</h1>
				    	</div>
			    	</div>
			    </div>
		    	<br>
	            {% for listing in listings %}
	            	<div class="row">
	            		<div class="col-xs-1"></div>
	            		<div class="col-xs-10" style="width: 100%">
			                <div class="card">
			                    <div class="card-header">
				                    <div class="row">
				                    	<div class="col-xs-10">
				                    		<a href="{{ url_for('listings.viewListing', listingID=listing.id) }}">
				                    			<h3><strong>{{ listing.street }}, {{ listing.city }} {{ listing.state }}</strong></h3>
				                    			<small>Lease Period: {{ listing.start_date }} - {{ listing.end_date }}</small>
				                    		</a>
				                    	</div>
				                    	<div class="col-xs-2" style="text-align: right;">
				                    		<a href="#" class="btn btn-primary">Edit Listing</a>
				                    	</div>
				                    </div>			                    
			                    </div>
			                    <div class="card-block">
				                    <div class="row">
				                    	<div class="col-xs-4">
				                    		<img src="{{url_for('static', filename='img/testHouse.jpg')}}" class="listingImg">
				                    	</div>
				                    	<div class="col-xs-8">
				                    		<h3><strong style="color:green;"><i class="fa fa-usd" aria-hidden="true"></i>{{ listing.price }}</strong> per bedroom per semester</h3>
				                    		<h3><strong>{{ listing.num_bedrooms }}<i class="fa fa-bed" aria-hidden="true"></i>
				                    		&nbsp;
				                    		{{ listing.num_full_baths }}<i class="fa fa-bath" aria-hidden="true"></i></strong></h3>
				                    	</div>
				                    </div>
			                    </div>
			                </div>
		                </div>
	                </div>
	            {% endfor %}
	        </div>
	        <div class="tab-pane" id="toursTab" role="tabpanel" style="padding: 0px;">
	        	<div class="row">
			    	<div class="col-xs-1"></div>
			    	<div class="col-xs-10" style="width: 100%">
				    	<div class="callout-block text-center fade-in-b">
				    		<h1>Tours</h1>
				    	</div>
			    	</div>
			    </div>
		    	<br>
		    	<div class="row">
		        	<div class="col-xs-1"></div>
		        	<div class="col-md-10 col-lg-10 col-xl-10">
		        	    <div class="row">
		        	        <div class="card" style="width:100%; border: none;">
		        	            <div class="card-block">
		        	                <ul class="nav nav-tabs">
		        	                    <li class="nav-item">
		        	                        <a class="nav-link active" data-toggle="tab" href="#requestedToursTab" role="tab">Requested Tours</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#scheduledToursTab" role="tab">Scheduled Tours</a>
		        	                    </li>
		        	                </ul>
		        	                <br>
		        	                <div class="tab-content">
		        	                    <div class="tab-pane active" id="requestedToursTab" role="tabpanel" style="padding: 0px;">
		        	                        {% if requestedTours %}
		        	                            {% for tourObject in requestedTours %}
		        	                            	<div id="numberOfRequestedTours{{tourObject.listing.id}}" style="display: none;">{{tourObject.tours|length }}</div>
		        	                            	<div id="doIShowDiv{{tourObject.listing.id}}" style="display: none;">show</div>
		        	                            	<div class="card" id="requestedTourListing{{tourObject.listing.id}}" style="width:100%; border: 0px solid rgba(0, 0, 0, 0.125);">
        							                    <div class="card-header" style="border-bottom: 0px solid rgba(0, 0, 0, 0.125);">
        								                    <div class="row">
        								                    	<div class="col-xl-12">
        								                    		<h3 id="requestedToursCount{{tourObject.listing.id}}"><strong>
        								                    		{{tourObject.tours|length }} Request(s) to tour {{tourObject.listing.street}}</strong></h3>
        								                    		<small>Lease Period: {{ tourObject.listing.start_date }} - {{ tourObject.listing.end_date }}</small>
        								                    	</div>
        								                    </div>			                    
        							                    </div>
        							                    <div class="card-block">
					        	                            <!-- <div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
	        							                    	    {% with listing=tourObject.listing %}
	        							                    	        {% include 'listing.html' %}
	        							                    	    {% endwith %}
	        							                    	</div>
        							                    	</div> -->
        							                    	<div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
        							                    			<strong><h2>Group(s) Requesting This Tour: </h2></strong>
        							                    		</div>
        							                    	</div>
	        	                    	        			{% for tour in tourObject.tours %}
	        	                    	        				<div class="row" id="requestedTour{{tour.id}}">
	        	                    	        					<div class="col-xl-1"></div>
	        	                    	        					<div class="col-xl-10">
			        	                    	        				<div class="card">
		        							                    			<div class="card-header">
		        							                    				<div class="row">
		        								                    				<div class="col-xl-10">
					        	                    	            					<h3><strong>{{tour.group.name}} </strong>({{tour.group.acceptedUsers|count}} Members)</h3>
					        	                    	            					Requested Date and Time: {{tour.time_requested}}
					        	                    	            					<br><br>
					        	                    	            					<div class="row">
					        	                    	            						{% if tour.last_requested == 'group' %}
						        	                    	            						<div class="col-12 col-md-auto" style="padding-left: 15px;padding-right: 15px;">
								        	                    	            					<div id="acceptTourButton{{tour.id}}">
								        	                    	            						<button class="btn btn-success" onclick="acceptTour({{tour.id}}, {{tourObject.listing.id}}, '{{tourObject.listing.street}}')">Accept Tour</button>
								        	                    	            					</div>
								        	                    	            					<div id="acceptTourLoading{{tour.id}}" style="display: none;">
								        	                    	            						<button class="btn btn-success" style="width: 117.5px;">
								        	                    	            							<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
								        	                    	            						</button>
								        	                    	            					</div>
								        	                    	            				</div>
								        	                    	            				<div class="col-12 col-md-auto" style="padding-right: 15px;">
								        	                    	            					<a href="#!" class="btn btn-info" data-toggle="modal" data-target="#suggestTimeTourModal" data-tourid="{{tour.id}}" data-groupid="{{tour.group.id}}">Request Date/Time Change</a>
								        	                    	            				</div>
								        	                    	            			{% else %}
								        	                    	            				<div class="col-12 col-md-auto" style="padding-left: 15px; padding-right: 15px;">
								        	                    	            					<button class="btn btn-secondary" disabled>Waiting For Group</button>
								        	                    	            				</div>
							        	                    	            				{% endif %}
							        	                    	            				<div class="col-12 col-md-auto">
							        	                    	            					<div id="declineTourButton{{tour.id}}">
							        	                    	            						<button class="btn btn-danger" onclick="declineTour({{tour.id}}, {{tourObject.listing.id}}, '{{tourObject.listing.street}}')">Decline Tour</button>
							        	                    	            					</div>
							        	                    	            					<div id="declineTourLoading{{tour.id}}" style="display: none;">
							        	                    	            						<button class="btn btn-danger" style="width: 117.5px;">
							        	                    	            							<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
							        	                    	            						</button>
							        	                    	            					</div>
							        	                    	            				</div>
						        	                    	            				</div>
					        	                    	            				</div>
					        	                    	            				<div class="col-xl-2" style="text-align: right;">
					        	                    	            					<a class="btn btn-primary" href="{{ url_for('tours.viewTour', tourID=tour.id) }}">View Request</a>
					        	                    	            				</div>
					        	                    	            			</div>
					        	                    	            		</div>
					        	                    	            		<div class="card-block">
		        							                    				<div class="row">
		        							                    					<div class="col-xs-12">
					        								                    		<strong>Tour Status: </strong>		
					        								                    		{% if tour.last_requested == 'landlord' %}
					        								                    			Pending The Group's Decision
					        								                    			<br>
					        								                    			Waiting for the group leader, {{ tour.group.leader.name }} to confirm the requested time or suggest a different one
					        								                    		{% else %}
					        								                    			Pending Your Decision
					        								                    			<br>
					        								                    			Waiting for the you to confrim the requested time or suggest a different one
					        								                    		{% endif %}
					        								                    		<br><br>
					        								                    		<strong>Group Leader:</strong>
					        								                    		{% for user in tour.group.acceptedUsers %}
					        								                    			{% with group=tour.group %}
					        								                    				<div class="row">
					        								                    					<div class="col-xs-12">
					        								                    						{% if group.leader_id == user.id %}
					        								                    		    				{% include 'landlord/member.html' %}
					        								                    						{% endif %}
					        								                    		    		</div>
					        								                    		    	</div>
					        								                    		    {% endwith %}
					        								                    		{% endfor %}
					                    			      					    		<div id="allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}" style="display: none;">
					                    		      					    				{% for user in tour.group.acceptedUsers %}
					                    		      					    					{% with group=tour.group %}         
					                    		      					    						<div class="row">
					                    		      					    							<div class="col-xs-12">
					                    		      					    								{% if not group.leader_id == user.id %}
					                    		      					    				    				{% include 'landlord/member.html' %}
					                    		      					    				    			{% endif %}
					                    		      					    				    		</div>
					                    		      					    				    	</div>
					                    		      					    				    {% endwith %}
					                    		      					    				{% endfor %}
					                    			      					    		</div>
					                    			      					    		<button class="btn btn-info" id="allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}"><i class='fa fa-users' aria-hidden='true'></i> See other {{tour.group.acceptedUsers|count-1}} members</button>
					                    			      					    		<button class="btn btn-info" id="hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}" style="display: none;"><i class='fa fa-users' aria-hidden='true'></i> Hide other {{tour.group.acceptedUsers|count-1}} members</button>
					                    			      					    		<script type="text/javascript">
					                    			      					    			//Show/hide members of group
					                    			      					    			$("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").click(function(){
					                    			      					    			    $("#allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}").toggle();
					                    			      					    			    $("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").hide();
					                    			      					    			    $("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").show();   	
					                    			      					    			});

					                    			      					    			$("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").click(function(){
					                    			      					    			    $("#allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}").toggle();
					                    			      					    			    $("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").hide();
					                    			      					    			    $("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").show();   	
					                    			      					    			});

					                    			      					    			$(document).ready(function(){
					                    			      					    			    $('#confirmed{{tour.group.id}}Z{{tour.listing.id}}').popover({
					                    			      					    			        html: true,
					                    			      					    			        trigger: 'focus',
					                    			      					    			        template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title" style="background-color: #449d44; text-align: center; color: #ffffff;"></h3><div class="popover-content"></div></div>'
					                    			      					    			    });

					                    			      					    			    $('#pending{{tour.group.id}}Z{{tour.listing.id}}').popover({
					                    			      					    			        html: true,
					                    			      					    			        trigger: 'focus',
					                    			      					    			        template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title" style="background-color: #ec971f; text-align: center; color: #ffffff;"></h3><div class="popover-content"></div></div>'
					                    			      					    			    });
					                    			      					    			});
					                    			      					    		</script>
					                    			      					    	</div>
					                    			      					    </div>
					                    			      					</div>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
					                    			      		<div class="row" id="undoAcceptTourDiv{{tour.id}}" style="display: none;">
					                    			      			<div class="col-xl-1"></div>
					                    			      			<div class="col-xl-10">
					                    			      				<div class="alert alert-info" role="alert">
					                    			      				    You have just accepted a tour for {{ tour.time_requested }} <a href="#!" class="alert-link" onclick="undoAcceptTour({{tour.id}}, {{tourObject.listing.id}})">Undo?</a>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
					                    			      		<div class="row" id="undoDeclineTourDiv{{tour.id}}" style="display: none;">
					                    			      			<div class="col-xl-1"></div>
					                    			      			<div class="col-xl-10">
					                    			      				<div class="alert alert-info" role="alert">
					                    			      				    You have just declined a tour for {{ tour.time_requested }} <a href="#!" class="alert-link" onclick="undoDeclineTour({{tour.id}}, {{tourObject.listing.id}})">Undo?</a>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
	        	                    	        			{% endfor %}
					        	                        </div>
					        	                    </div>
			            						{% endfor %}
			            						<div id="noRequestedTours" style="display: none;" class="alert alert-info" role="alert">
			            							<strong>No Requested Tours</strong>
			            						</div>
		            						{% else %}
		            							<div class="alert alert-info" role="alert">
		            								<strong>No Requested Tours</strong>
		            							</div>
		            						{% endif %}
		        	                    </div>
		        	                    <div class="tab-pane" id="scheduledToursTab" role="tabpanel" style="padding: 0px;">
		        	                        {% if scheduledTours %}
		        	                            {% for tourObject in scheduledTours %}
		        	                            	<div id="numberOfScheduledTours{{tourObject.listing.id}}" style="display: none;">{{tourObject.tours|length }}</div>
		        	                            	<div id="doIShowScheduledDiv{{tourObject.listing.id}}" style="display: none;">show</div>
		        	                            	<div class="card" id="scheduledTourListing{{tourObject.listing.id}}" style="width:100%; border: 0px solid rgba(0, 0, 0, 0.125);">
        							                    <div class="card-header" style="border-bottom: 0px solid rgba(0, 0, 0, 0.125);">
        								                    <div class="row">
        								                    	<div class="col-xl-12">
        								                    		<h3 id="requestedToursCount{{tourObject.listing.id}}"><strong>
        								                    		{{tourObject.tours|length }} Scheduled tour(s) of {{tourObject.listing.street}}</strong></h3>
        								                    		<small>Lease Period: {{ tourObject.listing.start_date }} - {{ tourObject.listing.end_date }}</small>
        								                    	</div>
        								                    </div>			                    
        							                    </div>
        							                    <div class="card-block">
					        	                            <!-- <div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
	        							                    	    {% with listing=tourObject.listing %}
	        							                    	        {% include 'listing.html' %}
	        							                    	    {% endwith %}
	        							                    	</div>
        							                    	</div> -->
        							                    	<div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
        							                    			<strong><h2>Group(s) Requesting This Tour: </h2></strong>
        							                    		</div>
        							                    	</div>
	        	                    	        			{% for tour in tourObject.tours %}
	        	                    	        				<div class="row" id="scheduledTour{{tour.id}}">
	        	                    	        					<div class="col-xl-1"></div>
	        	                    	        					<div class="col-xl-10">
			        	                    	        				<div class="card">
		        							                    			<div class="card-header">
		        							                    				<div class="row">
		        								                    				<div class="col-xl-10">
					        	                    	            					<h3><strong>{{tour.group.name}}</strong>({{tour.group.acceptedUsers|count}} Members)</h3>
					        	                    	            					Confirmed Date and Time: {{tour.time_requested}}
					        	                    	            					<br><br>
					        	                    	            					<div class="row">
					        	                    	            						<div class="col-12 col-md-auto">
							        	                    	            					<div id="cancelTourButton{{tour.id}}" style="padding-left: 15px;">
							        	                    	            						<button class="btn btn-danger" onclick="cancelTour({{tour.id}}, {{tourObject.listing.id}}, '{{tourObject.listing.street}}')">Cancel Tour</button>
							        	                    	            					</div>
							        	                    	            					<div id="cancelTourLoading{{tour.id}}" style="display: none; padding-left: 15px;">
							        	                    	            						<button class="btn btn-danger" style="width: 117.5px;">
							        	                    	            							<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
							        	                    	            						</button>
							        	                    	            					</div>
							        	                    	            				</div>
					        	                    	            					</div>
					        	                    	            				</div>
					        	                    	            				<div class="col-xl-2" style="text-align: right;">
					        	                    	            					<a class="btn btn-primary" href="{{ url_for('tours.viewTour', tourID=tour.id) }}">View Request</a>
					        	                    	            				</div>
					        	                    	            			</div>
					        	                    	            		</div>
					        	                    	            		<div class="card-block">
		        							                    				<div class="row">
		        							                    					<div class="col-xs-12">
					        								                    		<strong>Tour Status: </strong>
					        								                    		Confirmed
					        								                    		<br>
					        								                    		Please Arrive at the property on {{tour.time_requested}} to meet for this tour
					        								                    		<br><br>
					        								                    		<strong>Group Leader:</strong>
					        								                    		{% for user in tour.group.acceptedUsers %}
					        								                    			{% with group=tour.group %}
					        								                    				<div class="row">
					        								                    					<div class="col-xs-12">
					        								                    						{% if group.leader_id == user.id %}
					        								                    		    				{% include 'landlord/member.html' %}
					        								                    						{% endif %}
					        								                    		    		</div>
					        								                    		    	</div>
					        								                    		    {% endwith %}
					        								                    		{% endfor %}
					                    			      					    		<div id="allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}" style="display: none;">
					                    		      					    				{% for user in tour.group.acceptedUsers %}
					                    		      					    					{% with group=tour.group %}         
					                    		      					    						<div class="row">
					                    		      					    							<div class="col-xs-12">
					                    		      					    								{% if not group.leader_id == user.id %}
					                    		      					    				    				{% include 'landlord/member.html' %}
					                    		      					    				    			{% endif %}
					                    		      					    				    		</div>
					                    		      					    				    	</div>
					                    		      					    				    {% endwith %}
					                    		      					    				{% endfor %}
					                    			      					    		</div>
					                    			      					    		<button class="btn btn-info" id="allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}"><i class='fa fa-users' aria-hidden='true'></i> See other {{tour.group.acceptedUsers|count-1}} members</button>
					                    			      					    		<button class="btn btn-info" id="hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}" style="display: none;"><i class='fa fa-users' aria-hidden='true'></i> Hide other {{tour.group.acceptedUsers|count-1}} members</button>
					                    			      					    		<script type="text/javascript">
					                    			      					    			//Show/hide members of group
					                    			      					    			$("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").click(function(){
					                    			      					    			    $("#allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}").toggle();
					                    			      					    			    $("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").hide();
					                    			      					    			    $("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").show();   	
					                    			      					    			});

					                    			      					    			$("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").click(function(){
					                    			      					    			    $("#allMembersRequestedTour{{tour.group.id}}Z{{tour.listing.id}}").toggle();
					                    			      					    			    $("#hideAllMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").hide();
					                    			      					    			    $("#allMembersRequestedTourToggle{{tour.group.id}}Z{{tour.listing.id}}").show();   	
					                    			      					    			});

					                    			      					    			$(document).ready(function(){
					                    			      					    			    $('#confirmed{{tour.group.id}}Z{{tour.listing.id}}').popover({
					                    			      					    			        html: true,
					                    			      					    			        trigger: 'focus',
					                    			      					    			        template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title" style="background-color: #449d44; text-align: center; color: #ffffff;"></h3><div class="popover-content"></div></div>'
					                    			      					    			    });

					                    			      					    			    $('#pending{{tour.group.id}}Z{{tour.listing.id}}').popover({
					                    			      					    			        html: true,
					                    			      					    			        trigger: 'focus',
					                    			      					    			        template: '<div class="popover"><div class="arrow"></div><h3 class="popover-title" style="background-color: #ec971f; text-align: center; color: #ffffff;"></h3><div class="popover-content"></div></div>'
					                    			      					    			    });
					                    			      					    			});
					                    			      					    		</script>
					                    			      					    	</div>
					                    			      					    </div>
					                    			      					</div>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
					                    			      		<div class="row" id="undoCancelTourDiv{{tour.id}}" style="display: none;">
					                    			      			<div class="col-xl-1"></div>
					                    			      			<div class="col-xl-10">
					                    			      				<div class="alert alert-info" role="alert">
					                    			      				    You have just canceled a tour for {{ tour.time_requested }} <a href="#!" class="alert-link" onclick="undoCancelTour({{tour.id}}, {{tourObject.listing.id}})">Undo?</a>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
	        	                    	        			{% endfor %}
					        	                        </div>
					        	                    </div>
			            						{% endfor %}
			            						<div id="noScheduledTours" style="display: none;" class="alert alert-info" role="alert">
			            							<strong>No Scheduled Tours</strong>
			            						</div>
		            						{% else %}
		            							<div class="alert alert-info" role="alert">
		            								<strong>No Scheduled Tours</strong>
		            							</div>
		            						{% endif %}
		        	                    </div>
		        	                </div>
		        	            </div>
		        	        </div>
		        	    </div>
		        	</div>
		        </div>
	        </div>
	        <div class="tab-pane" id="requestsTab" role="tabpanel" style="padding: 0px;">
	        	<div class="row">
			    	<div class="col-xs-1"></div>
			    	<div class="col-xs-10" style="width: 100%">
				    	<div class="callout-block text-center fade-in-b">
				    		<h1>Listing Requests</h1>
				    	</div>
			    	</div>
			    </div>
		    	<br>
		    	<div class="row">
		        	<div class="col-xs-1"></div>
		        	<div class="col-md-10 col-lg-10 col-xl-10">
		        	    <div class="row">
		        	        <div class="card" style="width:100%; border: none;">
		        	            <div class="card-block">
		        	                <ul class="nav nav-tabs">
		        	                    <li class="nav-item">
		        	                        <a class="nav-link active" data-toggle="tab" href="#unacceptedTab" role="tab">Unaccepted</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#acceptedTab" role="tab">Accepted</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#completedTab" role="tab">Completed</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#deniedTab" role="tab">Denied</a>
		        	                    </li>
		        	                </ul>
		        	                <br>
		        	                <div class="tab-content">
		        	                    <div class="tab-pane active" id="unacceptedTab" role="tabpanel" style="padding: 0px;">
		        	                    	{% if unAcceptedHousingRequests %}		        	                    	
		        	                    	    {% for housingRequestObject in unAcceptedHousingRequests %}
		        	                    	    	<div class="card" style="width:100%; border: 0px solid rgba(0, 0, 0, 0.125);">
        							                    <div class="card-header" style="border-bottom: 0px solid rgba(0, 0, 0, 0.125);">
        								                    <div class="row">
        								                    	<div class="col-xl-12">
        								                    		<h3><strong>
        								                    		{{housingRequestObject.houseRequests|length }} Request(s) for {{housingRequestObject.listing.street}}</strong></h3>
        								                    		<small>Lease Period: {{ housingRequestObject.listing.start_date }} - {{ housingRequestObject.listing.end_date }}</small>
        								                    	</div>
        								                    </div>			                    
        							                    </div>
        							                    <div class="card-block">
        							                    	<div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
	        							                    	    {% with listing=housingRequestObject.listing %}
	        							                    	        {% include 'listing.html' %}
	        							                    	    {% endwith %}
	        							                    	</div>
        							                    	</div>
        							                    	<div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
        							                    			<strong><h2>Group(s) Requesting This Listing: </h2></strong>
        							                    		</div>
        							                    	</div>
	        	                    	        			{% for housingRequest in housingRequestObject.houseRequests %}
	        	                    	        				<div class="row">
	        	                    	        					<div class="col-xl-1"></div>
	        	                    	        					<div class="col-xl-10">
			        	                    	        				<div class="card">
		        							                    			<div class="card-header">
		        							                    				<div class="row">
		        								                    				<div class="col-xl-10">
					        	                    	            					<h3><strong>{{housingRequest.group.name}}</strong>({{housingRequest.group.acceptedUsers|count}} Members)</h3>
					        	                    	            				</div>
					        	                    	            				<div class="col-xl-2" style="text-align: right;">
					        	                    	            					<a class="btn btn-primary" href="{{ url_for('housingRequests.view', id=housingRequest.id) }}">View Request</a>
					        	                    	            				</div>
					        	                    	            			</div>
					        	                    	            		</div>
					        	                    	            		<div class="card-block">
		        							                    				<div class="row">
		        							                    					<div class="col-xs-12">
						    								                    		<strong>Group Leader:</strong>
						    								                    		{% for user in housingRequest.group.acceptedUsers %}
						    								                    			{% with group=housingRequest.group %}         
						    								                    				<div class="row">
						    								                    					<div class="col-xs-12">
						    								                    						{% if group.leader_id == user.id %}
						    								                    		    				{% include 'landlord/member.html' %}
						    								                    						{% endif %}
						    								                    		    		</div>
						    								                    		    	</div>
						    								                    		    {% endwith %}
						    								                    		{% endfor %}
						                			      					    		<div id="allGroupMembersListingUnaccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}" style="display: none;">
						                		      					    				{% for user in housingRequest.group.acceptedUsers %}
						                		      					    					{% with group=housingRequest.group %}         
						                		      					    						<div class="row">
						                		      					    							<div class="col-xs-12">
						                		      					    								{% if not group.leader_id == user.id %}
						                		      					    				    				{% include 'landlord/member.html' %}
						                		      					    				    			{% endif %}
						                		      					    				    		</div>
						                		      					    				    	</div>
						                		      					    				    {% endwith %}
						                		      					    				{% endfor %}
						                			      					    		</div>
						                			      					    		<button class="btn btn-info" id="allGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}"><i class='fa fa-users' aria-hidden='true'></i> See other {{housingRequest.group.acceptedUsers|count-1}} members</button>
						                			      					    		<button class="btn btn-info" id="hideAllGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}" style="display: none"><i class='fa fa-users' aria-hidden='true'></i> Hide other {{housingRequest.group.acceptedUsers|count-1}} members</button>
						                			      					    		<script type="text/javascript">
						                			      					    			//Show/hide members of group
						                			      					    			$("#allGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").click(function(){
						                			      					    			    $("#allGroupMembersListingUnaccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").toggle();
						                			      					    			    $("#allGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").hide();
						                			      					    			    $("#hideAllGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").show();   	
						                			      					    			});

						                			      					    			$("#hideAllGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").click(function(){
						                			      					    			    $("#allGroupMembersListingUnaccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").toggle();
						                			      					    			    $("#allGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").show();
						                			      					    			    $("#hideAllGroupMembersListingUnacceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").hide();   	
						                			      					    			});
						                			      					    		</script>
						                			      					    	</div>
						                			      					    </div>
				                			      					    	</div>
		                    			      					    	</div>
		                    			      					    </div>
		                    			      					</div>
	        	                    	        			{% endfor %}		        	                    	        		
		        	                    	        	</div>
		        	                    	        </div>
		        	                    	        <hr>
		        	                    	    {% endfor %}
		        	                    	{% else %}
		        	                    		Nothing to display
		        	                    	{% endif %}
		        	                    </div>
		        	                    <div class="tab-pane" id="acceptedTab" role="tabpanel" style="padding: 0px;">
		        	                    	{% if acceptedHousingRequests %}
		        	                        	{% for housingRequest in acceptedHousingRequests %}
        							                <div class="card">
        							                    <div class="card-header">
        								                    <div class="row">
        								                    	<div class="col-xl-12">
        								                    		<h3><strong>{{ housingRequest.listing.street }} </strong></h3>
        								                    		<small>Lease Period: {{ housingRequest.listing.start_date }} - {{ housingRequest.listing.end_date }}</small>
        								                    	</div>
        								                    </div>			                    
        							                    </div>
        							                    <div class="card-block">
        								                    <div class="row">
        								                    	<div class="col-xs-4">
        								                    		<img src="{{url_for('static', filename='img/testHouse.jpg')}}" class="listingImg">
        								                    		<br><br>
        								                    		<a href="{{ url_for('housingRequests.view', id=housingRequest.id) }}" class="btn btn-primary">View Request</a>
        								                    	</div>
        								                    	<div class="col-xs-8">
        								                    		<div class="row">
        								                    			<div class="col-xl-12">
		        								                    		<h3><strong>Group requesting the listing: {{housingRequest.group.name}}</strong>({{housingRequest.group.acceptedUsers|count}} Members)</h3>		 
		        								                    	</div>
		        								                    </div>
		        								                    <div class="row">
		        								                    	<div class="col-xl-12">
		        								                    		<strong style="padding-right: 16px;">All Leases Collected: </strong>
		        								                    		<button type="button" id="pending" class="btn btn-danger btn-circle pending"><i class="fa fa-times" aria-hidden="true"></i></button>
		        								                    	</div>
		        								                    </div>
		        								                    <br>
		        								                    <div class="row">
		        								                    	<div class="col-xl-12">
		        								                    		<strong>All Deposits Collected: </strong>
		        								                    		<button type="button" id="pending" class="btn btn-danger btn-circle pending"><i class="fa fa-times" aria-hidden="true"></i></button>
		        								                    	</div>
		        								                    </div>
		        								                    <br>
		        								                    <div class="row">
		        								                    	<div class="col-xl-12">
		        								                    		<strong>Group Leader:</strong>
			        								                    		{% for deposit in housingRequest.securityDeposits %}
			        								                    			{% with group=housingRequest.group %}         
			        								                    				<div class="row">
			        								                    					<div class="col-xs-10">
			        								                    						{% if group.leader_id == deposit.user.id %}
			        								                    		    				{% include 'landlord/acceptedMember.html' %}
			        								                    						{% endif %}
			        								                    		    		</div>
			        								                    		    	</div>
			        								                    		    {% endwith %}
			        								                    		{% endfor %}
			                    			      					    		<div id="allGroupMembersListingAccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}" style="display: none;">
			                    		      					    				{% for deposit in housingRequest.securityDeposits %}
			                    		      					    					{% with group=housingRequest.group %}         
			                    		      					    						<div class="row">
			                    		      					    							<div class="col-xs-10">
			                    		      					    								{% if not group.leader_id == deposit.user.id %}
			                    		      					    				    				{% include 'landlord/acceptedMember.html' %}
			                    		      					    				    			{% endif %}
			                    		      					    				    		</div>
			                    		      					    				    	</div>
			                    		      					    				    {% endwith %}
			                    		      					    				{% endfor %}
			                    			      					    		</div>
			                    			      					    		<button class="btn btn-info" id="allGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}"><i class='fa fa-users' aria-hidden='true'></i> See other {{housingRequest.group.acceptedUsers|count-1}} members</button>
			                    			      					    		<button class="btn btn-info" id="hideAllGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}" style="display: none;"><i class='fa fa-users' aria-hidden='true'></i> Hide other {{housingRequest.group.acceptedUsers|count-1}} members</button>
			                    			      					    		<script type="text/javascript">
			                    			      					    			//Show/hide members of group
			                    			      					    			$("#allGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").click(function(){
			                    			      					    			    $("#allGroupMembersListingAccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").toggle();
			                    			      					    			    $("#allGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").hide();
			                    			      					    			    $("#hideAllGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").show();   	
			                    			      					    			});

			                    			      					    			$("#hideAllGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").click(function(){
			                    			      					    			    $("#allGroupMembersListingAccepted{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").toggle();
			                    			      					    			    $("#allGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").show();
			                    			      					    			    $("#hideAllGroupMembersListingAcceptedToggle{{housingRequest.group.id}}Z{{housingRequest.listing.id}}").hide();   	
			                    			      					    			});
			                    			      					    		</script>
			        								                    		<br>
			        								                    		<br>
			        								                    	</div>
			        								                    </div>
	        								                    	</div>
	        								                    </div>
	        							                    </div>
	        							                </div>
			            							<br>
			            						{% endfor %}
		            						{% endif %}
		        	                    </div>
		        	                </div>
		        	            </div>
		        	        </div>
		        	    </div>
		        	</div>
		        </div>
	        </div>
	        <div class="tab-pane" id="maintenanceTab" role="tabpanel" style="padding: 0px;">
	        	<div class="row">
			    	<div class="col-xs-1"></div>
			    	<div class="col-xs-10" style="width: 100%">
				    	<div class="callout-block text-center fade-in-b">
				    		<h1>Maintenance Requests</h1>
				    	</div>
			    	</div>
			    </div>
		    	<br>
		    	<div class="row">
		        	<div class="col-xs-1"></div>
		        	<div class="col-md-10 col-lg-10 col-xl-10">
		        	    <div class="row">
		        	        <div class="card" style="width:100%; border: none;">
		        	            <div class="card-block">
		        	                <ul class="nav nav-tabs">
		        	                    <li class="nav-item">
		        	                        <a class="nav-link active" data-toggle="tab" href="#newMaintenanceTab" role="tab">New Requests</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#inProgressMaintenanceTab" role="tab">In-Progress</a>
		        	                    </li>
		        	                    <li class="nav-item">
		        	                        <a class="nav-link" data-toggle="tab" href="#completedMaintenanceTab" role="tab">Completed</a>
		        	                    </li>
		        	                </ul>
		        	                <br>
		        	                <div class="tab-content">
		        	                    <div class="tab-pane active" id="newMaintenanceTab" role="tabpanel" style="padding: 0px;">
		        	                    	{% if openMaintenanceRequests|length > 0 %}
		        	                            {% for requestObject in openMaintenanceRequests %}		        	                            
		        	                            	<div id="numberOfOpenRequests{{requestObject.house.listing.id}}" style="display: none;">{{requestObject.maintenanceRequests|length }}</div>
		        	                            	<div id="doIShowOpenRequestsDiv{{requestObject.house.listing.id}}" style="display: none;">show</div>
		        	                            	<div class="card" id="openRequestListing{{requestObject.house.listing.id}}" style="width:100%; border: 0px solid rgba(0, 0, 0, 0.125);">
        							                    <div class="card-header" style="border-bottom: 0px solid rgba(0, 0, 0, 0.125);">
        								                    <div class="row">
        								                    	<div class="col-xl-12">
        								                    		<h3 id="openRequestsCount{{requestObject.house.listing.id}}"><strong>
        								                    		{{requestObject.maintenanceRequests|length }} New Maintenance Request(s) for {{requestObject.house.listing.street}}</strong></h3>
        								                    	</div>
        								                    </div>			                    
        							                    </div>
        							                    <div class="card-block">
        							                    	<div class="row">
        							                    		<div class="col-xl-1"></div>
        							                    		<div class="col-xl-10">
        							                    			<strong><h2>Group(s) Requesting This Tour: </h2></strong>
        							                    		</div>
        							                    	</div>
	        	                    	        			{% for request in requestObject.maintenanceRequests %}
	        	                    	        				<div class="row" id="openRequest{{request.id}}">
	        	                    	        					<div class="col-xl-1"></div>
	        	                    	        					<div class="col-xl-10">
			        	                    	        				<div class="card">
		        							                    			<div class="card-header">
		        							                    				<div class="row">
		        								                    				<div class="col-xl-10">
					        	                    	            					<h3><strong>{{request.request_type}} </strong></h3>
					        	                    	            					Reported on: {{request.date_created}}
					        	                    	            					<br><br>
					        	                    	            					<div class="row">   
					        	                    	            						<div class="col-12 col-md-auto" style="padding-left: 15px;padding-right: 15px;">
							        	                    	            					<div id="markInProgressButton{{request.id}}">
							        	                    	            						<button class="btn btn-warning" onclick="markInProgress({{request.id}}, {{requestObject.house.listing.id}}, '{{requestObject.house.listing.street}}')">Mark In Progress</button>
							        	                    	            					</div>
							        	                    	            					<div id="markInProgressLoading{{request.id}}" style="display: none;">
							        	                    	            						<button class="btn btn-warning" style="width: 117.5px;">
							        	                    	            							<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
							        	                    	            						</button>
							        	                    	            					</div>
							        	                    	            				</div>
							        	                    	            				<div class="col-12 col-md-auto" style="padding-left: 15px;padding-right: 15px;">
							        	                    	            					<div id="markCompletedButton{{request.id}}">
							        	                    	            						<button class="btn btn-success" onclick="markCompleted({{request.id}}, {{requestObject.house.listing.id}}, '{{requestObject.house.street}}')">Mark Completed</button>
							        	                    	            					</div>
							        	                    	            					<div id="completedLoading{{request.id}}" style="display: none;">
							        	                    	            						<button class="btn btn-success" style="width: 117.5px;">
							        	                    	            							<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>
							        	                    	            						</button>
							        	                    	            					</div>
							        	                    	            				</div>
						        	                    	            				</div>
					        	                    	            				</div>
					        	                    	            				<div class="col-xl-2" style="text-align: right;">
					        	                    	            					<a class="btn btn-primary" href="{{ url_for('houses.maintenanceRequestView', id=request.id) }}">View Request</a>
					        	                    	            				</div>
					        	                    	            			</div>
					        	                    	            		</div>
					        	                    	            		<div class="card-block">
		        							                    				<div class="row">
		        							                    					<div class="col-xs-12">
		        							                    						<strong>Reported by:</strong> {{request.user.name}}
		        							                    						<br><br>
		        							                    						<strong>Details: </strong>{{request.details}}
					                    			      					    	</div>
					                    			      					    </div>
					                    			      					</div>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
					                    			      		<div class="row" id="undoInProgressDiv{{request.id}}" style="display: none;">
					                    			      			<div class="col-xl-1"></div>
					                    			      			<div class="col-xl-10">
					                    			      				<div class="alert alert-info" role="alert">
					                    			      				    Marked as In Progress <a href="#!" class="alert-link" onclick="undoMarkInProgress({{request.id}}, {{request.house.listing.id}})">Undo?</a>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
					                    			      		<div class="row" id="undoCompletedDiv{{request.id}}" style="display: none;">
					                    			      			<div class="col-xl-1"></div>
					                    			      			<div class="col-xl-10">
					                    			      				<div class="alert alert-info" role="alert">
					                    			      				    Marked as Completed <a href="#!" class="alert-link" onclick="undoCompleted({{request.id}}, {{request.house.listing.id}})">Undo?</a>
					                    			      				</div>
					                    			      			</div>
					                    			      		</div>
	        	                    	        			{% endfor %}
					        	                        </div>
					        	                    </div>
			            						{% endfor %}
			            						<div id="noNewMaintenanceRequests" style="display: none;" class="alert alert-info" role="alert">
			            							<strong>No New Maintenance Requests</strong>
			            						</div>
		            						{% else %}
		            							<div class="alert alert-info" role="alert">
		            								<strong>No New Maintenance Requests</strong>
		            							</div>
		            						{% endif %}
		        	                    </div>
		        	                    <div class="tab-pane" id="inProgressMaintenanceTab" role="tabpanel" style="padding: 0px;">
		        	                    	In-Progress
		        	                    </div>
		        	                    <div class="tab-pane" id="completedMaintenanceTab" role="tabpanel" style="padding: 0px;">
		        	                    	Completed
		        	                    </div>
		        	                </div>
		        	            </div>
		        	        </div>
		        	    </div>
		        	</div>
		        </div>
		    </div>
	        <div class="tab-pane" id="paymentTab" role="tabpanel">
	            Payment Portal
	        </div>
		</div>
	</div>
</div>

    <!--Suggest Different Time Tour Modal-->
    <div class="modal fade" id="suggestTimeTourModal" tabindex="-1" role="dialog" aria-labelledby="suggestTimeTour" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title"></h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xs-1"></div>
                        <div class="col-xs-10">
                            <form id="request_tour_time_change" action="#" method="POST">
                                {{ dateChangeForm.csrf_token }}
                                {{ dateChangeForm.input_id }}
                                {{ dateChangeForm.requestedDateTime() }}                             
                                <p class="flatpickr input-group" data-wrap="true" data-clickOpens="false">
                                    <input id="tourRequestTime" placeholder="Pick date" data-input style="background-color: inherit;">
                                    <a class="btn input-btn" style="border-color: #ddd;" data-toggle><i class="fa fa-calendar" aria-hidden="true"></i></a>
                                    <a class="btn input-btn" style="border-color: #ddd;" data-clear><i class="fa fa-times" aria-hidden="true"></i></a>
                                </p>
                            </form>  
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="#" id="requestTimeLink" class="btn btn-primary" onclick="#">Request Time</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}
<script>
	function acceptTour(id, surroundingID, listing){
		var count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
        $("#acceptTourButton"+id).hide();
        $("#acceptTourLoading"+id).show();
        setTimeout(function () {
        	$("#requestedTour"+id).fadeOut(300);
        	$("#undoAcceptTourDiv"+id).show(500);
        	$("#undoAcceptTourDiv"+id).delay(8000).fadeOut(300);
        }, 1200);
        requestURL = '/tour/' + id + '/confirm/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour accepted now we need to move this element to 'Scheduled Tours'... make sure to make the button think toO!");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowDiv"+surroundingID).html("hide");
        $("#numberOfRequestedTours"+surroundingID).html(count-1);
        setTimeout(function () {
        	count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
        	if(count == 0){
        		if($("#doIShowDiv"+surroundingID).html() == "hide"){
        			$("#requestedTourListing"+surroundingID).fadeOut(300);
        			$("#noRequestedTours").show();
        		}
        	}
        	else if(count == 1){
        		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
        		$("#noRequestedTours").hide();
        	}
        	else if(count > 1){
        		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
        		$("#noRequestedTours").hide();
        	}        	
        }, 10000);
    }

    function undoAcceptTour(id, surroundingID){
    	var count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
    	$("#acceptTourLoading"+id).hide();
        $("#acceptTourButton"+id).show();
        $("#undoAcceptTourDiv"+id).hide();
        $("#requestedTour"+id).show();
        requestURL = '/tour/' + id + '/unConfirm/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour has been un-accepted now we need to move this element to 'Requested Tours'");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowDiv"+surroundingID).html("show");
        if(count-1 == 0){
    		$("#requestedTourListing"+surroundingID).fadeIn(300);
    	}
    	else if(count-1 == 1){
    		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
    	}
    	else if(count-1 > 1){
    		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
    	}
    	$("#numberOfRequestedTours"+surroundingID).html(count+1);
    	$("#noRequestedTours").hide();
    }

    function declineTour(id, surroundingID, listing){
    	var count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
    	$("#declineTourButton"+id).hide();
        $("#declineTourLoading"+id).show();
        setTimeout(function () {
        	$("#requestedTour"+id).fadeOut(300);
        	$("#undoDeclineTourDiv"+id).show(500);
        	$("#undoDeclineTourDiv"+id).delay(8000).fadeOut(300);
        }, 1200);
        requestURL = '/tour/' + id + '/decline/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour has been declined, just hide element after 5 seconds or so along with the undo button'");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowDiv"+surroundingID).html("hide");
        $("#numberOfRequestedTours"+surroundingID).html(count-1);
        setTimeout(function () {
        	count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
        	if(count == 0){
        		if($("#doIShowDiv"+surroundingID).html() == "hide"){
        			$("#requestedTourListing"+surroundingID).fadeOut(300);
        			$("#noRequestedTours").show();
        		}
        	}
        	else if(count == 1){
        		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
        		$("#noRequestedTours").hide();
        	}
        	else if(count > 1){
        		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
        		$("#noRequestedTours").hide();
        	}        	
        }, 10000);
    }

    function undoDeclineTour(id, surroundingID){
    	$("#numberOfRequestedTours"+surroundingID).html(count+1);
    	var count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
    	$("#declineTourLoading"+id).hide();
        $("#declineTourButton"+id).show();
        $("#declineTourUndo"+id).hide();
        $("#undoDeclineTourDiv"+id).hide();
        $("#requestedTour"+id).show();
        requestURL = '/tour/' + id + '/unDecline/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour has been unDeclined, Don't hide it!");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowDiv"+surroundingID).html("show");
        if(count-1 == 0){
    		$("#requestedTourListing"+surroundingID).fadeIn(300);    		
    	}
    	else if(count-1 == 1){
    		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
    	}
    	else if(count-1 > 1){
    		$("#requestedToursCount"+surroundingID).html("<h3><strong>" + count + " Request(s) to tour  " + listing + "</h3></strong>");
    	}    	
    	$("#noRequestedTours").hide();
    }

    function cancelTour(id, surroundingID, listing){
    	var count = parseFloat($("#numberOfScheduledTours"+surroundingID).html()) || 0;
    	$("#cancelTourButton"+id).hide();
        $("#cancelTourLoading"+id).show();
        setTimeout(function () {
        	$("#scheduledTour"+id).fadeOut(300);
        	$("#undoCancelTourDiv"+id).show(500);
        	$("#undoCancelTourDiv"+id).delay(8000).fadeOut(300);
        }, 1200);
        requestURL = '/tour/' + id + '/decline/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour has been declined, just hide element after 5 seconds or so along with the undo button'");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowScheduledDiv"+surroundingID).html("hide");
        $("#numberOfScheduledTours"+surroundingID).html(count-1);
        setTimeout(function () {
        	count = parseFloat($("#numberOfScheduledTours"+surroundingID).html()) || 0;
        	if(count == 0){
        		if($("#doIShowScheduledDiv"+surroundingID).html() == "hide"){
        			$("#scheduledTourListing"+surroundingID).fadeOut(300);
        			$("#noScheduledTours").show();
        		}
        	}
        	else if(count == 1){
        		$("#scheduledToursCount"+surroundingID).html("<h3><strong>" + count + " Scheduled tour(s) of " + listing + "</h3></strong>");
        		$("#noScheduledTours").hide();
        	}
        	else if(count > 1){
        		$("#scheduledToursCount"+surroundingID).html("<h3><strong>" + count + " Scheduled tour(s) of " + listing + "</h3></strong>");
        		$("#noScheduledTours").hide();
        	}        	
        }, 10000);
    }

    function undoCancelTour(id, surroundingID){
    	$("#numberOfScheduledTours"+surroundingID).html(count+1);
    	var count = parseFloat($("#numberOfScheduledTours"+surroundingID).html()) || 0;
    	$("#cancelTourLoading"+id).hide();
        $("#cancelTourButton"+id).show();
        $("#cancelTourUndo"+id).hide();
        $("#undoCancelTourDiv"+id).hide();
        $("#scheduledTour"+id).show();
        requestURL = '/tour/' + id + '/unDecline/ajax';
        $.getJSON(requestURL, function(data) {
            results = data['results'];
            // alert(data['results'].success);
            if (results.success == true){ 
                //alert("Tour has been unDeclined, Don't hide it!");
            } else {
                alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
            }
        });
        $("#doIShowScheduledDiv"+surroundingID).html("show");
        if(count-1 == 0){
    		$("#scheduledTourListing"+surroundingID).fadeIn(300);
    	}
    	else if(count-1 == 1){
    		$("#scheduledToursCount"+surroundingID).html("<h3><strong>" + count + " Scheduled tour(s) of " + listing + "</h3></strong>");
    	}
    	else if(count-1 > 1){
    		$("#scheduledToursCount"+surroundingID).html("<h3><strong>" + count + " Scheduled tour(s) of " + listing + "</h3></strong>");
    	}    	
    	$("#noScheduledTours").hide();
    }

    function markInProgress(id, surroundingID, listing){
		var count = parseFloat($("#numberOfOpenRequests"+surroundingID).html()) || 0;
        $("#markInProgressButton"+id).hide();
        $("#markInProgressLoading"+id).show();
        setTimeout(function () {
        	$("#openRequest"+id).fadeOut(300);
        	$("#undoInProgressDiv"+id).show(500);
        	$("#undoInProgressDiv"+id).delay(8000).fadeOut(300);
        }, 1200);
        // requestURL = '/tour/' + id + '/confirm/ajax';
        // $.getJSON(requestURL, function(data) {
        //     results = data['results'];
        //     // alert(data['results'].success);
        //     if (results.success == true){ 
        //         //alert("Tour accepted now we need to move this element to 'Scheduled Tours'... make sure to make the button think toO!");
        //     } else {
        //         alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
        //     }
        // });
        $("#doIShowOpenRequestsDiv"+surroundingID).html("hide");
        $("#numberOfOpenRequests"+surroundingID).html(count-1);
        setTimeout(function () {
        	count = parseFloat($("#numberOfOpenRequests"+surroundingID).html()) || 0;
        	if(count == 0){
        		if($("#doIShowOpenRequestsDiv"+surroundingID).html() == "hide"){
        			$("#openRequestListing"+surroundingID).fadeOut(300);
        			//$("#noRequestedTours").show();
        		}
        	}
        	else if(count == 1){
        		$("#openRequestsCount"+surroundingID).html("<h3><strong>" + count + ' New Maintenance Request(s) for ' + listing + "</strong></h3>");
        		//$("#noRequestedTours").hide();
        	}
        	else if(count > 1){
        		$("#openRequestsCount"+surroundingID).html("<h3><strong>" + count + ' New Maintenance Request(s) for ' + listing + "</strong></h3>");
        		//$("#noRequestedTours").hide();
        	}        	
        }, 10000);
    }

    function undoMarkInProgress(id, surroundingID){
    	$("#numberOfOpenRequests"+surroundingID).html(count+1);
    	var count = parseFloat($("#numberOfRequestedTours"+surroundingID).html()) || 0;
    	$("#markInProgressLoading"+id).hide();
        $("#markInProgressButton"+id).show();
        $("#undoInProgressDiv"+id).hide();
        $("#openRequest"+id).show();
        // requestURL = '/tour/' + id + '/unConfirm/ajax';
        // $.getJSON(requestURL, function(data) {
        //     results = data['results'];
        //     // alert(data['results'].success);
        //     if (results.success == true){ 
        //         //alert("Tour has been un-accepted now we need to move this element to 'Requested Tours'");
        //     } else {
        //         alert('IT DIDN"T WORK.... why idk. but here is the error message : ' + results.message);
        //     }
        // });
        $("#doIShowOpenRequestsDiv"+surroundingID).html("show");
        if(count-1 == 0){
    		$("#openRequest"+surroundingID).fadeIn(300);
    	}
    	else if(count-1 == 1){
    		$("#openRequestsCount"+surroundingID).html("<h3><strong>" + count + ' New Maintenance Request(s) for ' + listing + "</strong></h3>");
    	}
    	else if(count-1 > 1){
    		$("#openRequestsCount"+surroundingID).html("<h3><strong>" + count + ' New Maintenance Request(s) for ' + listing + "</strong></h3>");
    	}    	
    	$("#noNewMaintenanceRequests").hide();
    }

	$(document).ready(function() {
	    flatpickr(".flatpickr", {
	        enableTime: true,
	        altInput: true,
	        altFormat: "F j, Y h:i K",
	        minuteIncrement: 15,
	        disable: [{from: "0001-01-01",
	                  to: "today"}]
	    });
	    $('.flatpickr-calendar').css('z-index', 99999999999999);
	});

	$(document).ready(function(){
	   $('[data-toggle="offcanvas"]').click(function(){
	       $("#navigation").toggleClass("hidden-xs");
	   });
	});

    //Suggest Tour Time Modal
    $('#suggestTimeTourModal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget);
      var modal = $(this);
      var tour = $(event.relatedTarget).data('tourid');
      var group = $(event.relatedTarget).data('groupid');
      $("#request_tour_time_change").attr('action', "/tour/"+tour+"/updateDate");
      $("#requestTimeLink").attr('onClick', "submitTimeChangeForm("+group+")");      
      modal.find('.modal-title').text('Request Different Time For Tour');
    })

    function submitTimeChangeForm(id) {
        $("#input_id").val(id);
        $("#requestedDateTime").val($("#tourRequestTime").val());
        $("#request_tour_time_change").submit()
    }   

</script>
{% endblock %}