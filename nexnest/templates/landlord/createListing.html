{% extends "base.html" %} {% block content %}
<br>
<div class="row">
    <div class="col-xs-0 col-sm-1 col-md-2 col-lg-2 col-xl-3">
    </div>
    <div class="col-xs-12 col-sm-10 col-md-8 col-lg-8 col-xl-6">
        <div class="stepwizard col-xs-12">
            <div class="stepwizard-row setup-panel">
                <div class="stepwizard-step">
                    <a href="#step-1" type="button" class="btn btn-primary btn-circle">1</a>
                    <p>Address</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-2" type="button" class="btn btn-default btn-circle ">2</a>
                    <p>Rental Time</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-3" type="button" class="btn btn-default btn-circle ">3</a>
                    <p>Property Details</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-4" type="button" class="btn btn-default btn-circle ">4</a>
                    <p>Appliances</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-5" type="button" class="btn btn-default btn-circle ">5</a>
                    <p>Services</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-6" type="button" class="btn btn-default btn-circle ">6</a>
                    <p>Description</p>
                </div>
                <div class="stepwizard-step">
                    <a href="#step-7" type="button" class="btn btn-default btn-circle ">7</a>
                    <p>Photos</p>
                </div>
            </div>
        </div>
        <form id="createListingForm" action="{{url_for('listings.createListing')}}" role="form" data-toggle="validator" method='POST'>
            {{form.csrf_token}}
            <div class="row setup-content" id="step-1">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3> Step 1: Address</h3>
                            <div class="form-group">
                                <label class="control-label form-control-feedback">Street Address</label>
                                {{form.street(class='form-control', required='required')}}
                            </div>
                            <div class="form-group">
                                <label class="control-label form-control-feedback">City</label>
                                {{form.city(class='form-control', required='required')}}
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label">State</label>
                                        {{form.state(class='form-control', required='required')}}
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Zip Code</label>
                                        {{form.zip_code(class='form-control', required='required', maxlength='5')}}
                                        <!-- <input id="zip_code" required="required" maxlength="5" name="zip_code" type="text" class="form-control" /> -->
                                    </div>
                                </div>
                            </div>
                            <button id="zipCodeButton" class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-2">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3> Step 2: Rental Time Period</h3>
                            <div class="form-group">
                                <label class="control-label form-control-feedback">Time Period</label>
                                {{form.time_period(class='form-control', required='required')}}
                                <!-- <select class="form-control" required="required" name="time_period" id="time_period">
                                    <option value="school_year">School Year</option>
                                    <option value="full_year">Full Year</option>
                                    <option value="summer">Summer</option>
                                </select> -->
                            </div>
                            <div class="form-group" id="startDate">
                                <label class="control-label form-control-feedback">Lease Start Date</label>
                                <!-- {{form.start_date(class='form-control', required='required', maxlength='100', type="date")}} -->
                                <p id="start" class="flatpickr input-group" data-wrap="true" data-clickOpens="false">
                                	{{form.start_date(id="leaseStartDateInput", class='form-control', data_input="true", required='required', maxlength='100', type="date", style="background-color: inherit;")}}
                                	<a class="btn input-btn" style="border-color: #ddd;" data-toggle><i class="fa fa-calendar" aria-hidden="true"></i></a>
                                	<a class="btn input-btn" style="border-color: #ddd;" data-clear><i class="fa fa-times" aria-hidden="true"></i></a>
                                </p>
                               <!--  <input id="start_date" name="start_date" maxlength="100" type="date" required="required" class="form-control" /> -->
                            </div>
                            <div class="form-group" id="endDate">
                                <label class="control-label form-control-feedback">Lease End Date</label>
                                <p id="end" class="flatpickr input-group" data-wrap="true" data-clickOpens="false">
                                	{{form.end_date(id="endLeaseDateInput", class='form-control', data_input="true", required='required', maxlength='100', type="date", style="background-color: inherit;")}}
                                	<a class="btn input-btn" style="border-color: #ddd;" data-toggle><i class="fa fa-calendar" aria-hidden="true"></i></a>
                                	<a class="btn input-btn" style="border-color: #ddd;" data-clear><i class="fa fa-times" aria-hidden="true"></i></a>
                                </p>
                                <!-- <input id="end_date" name="end_date" maxlength="100" type="date" required="required" class="form-control" /> -->
                            </div>
                            <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-3">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3> Step 3: Property Details</h3>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Type of Property</label>
                                        {{form.property_type(class='form-control', required='required')}}
                                        <!-- <select class="form-control" required="required" name="property_type" id="property_type">
                                            <option value="house">House</option>
                                            <option value="apartment">Apartment</option>
                                            <option value="complex">Complex</option>
                                            <option value="room">Room</option>
                                        </select> -->
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Square Footage of Property</label>
                                        <div class="input-group">
                                        	{{form.square_footage(class='form-control', required='required', maxlength='100')}}
                                        	<span class="input-group-addon">FT</span>
                                        </div>
                                        <!-- <input id="footage" maxlength="100" type="number" name="square_footage" required="required" class="form-control" /> -->
                                    </div>
                                </div>
                            </div>
                            <div class="form-group" style="display: none;" id="apartmentNumberInput">
                                <label class="control-label form-control-feedback" id="apartment_number_label">Apartment Number</label>
                                {{form.apartment_number(class='form-control')}}
                                <!-- <input id="apartment_number" name="apartment_number" maxlength="100" type="number" class="form-control" /> -->
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">How often is rent due?</label>
                                        {{form.rent_due(class='form-control', required='required')}}
                                        <!-- <select class="form-control" required="required" name="rent_due" id="rent_due">
                                            <option value="monthly">Per Month</option>
                                            <option value="semester">Per Semester</option>
                                        </select> -->
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="price_label">Price Per Bedroom per Month</label>
                                        <div class="input-group">
                                        	<span class="input-group-addon">$</span>
                                        	{{form.price(class='form-control', required='required')}}
                                        </div>
                                        <!-- <input id="price" maxlength="100" type="number" required="required" class="form-control" /> -->
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="utilities_label">Are Utilities Included in This price?</label>
                                        <div class="input-group">
                                            <div id="radioBtn" class="btn-group">
                                                <a class="btn btn-primary btn-sm active" data-toggle="utilities" data-title="N">No</a>
                                                <a class="btn btn-primary btn-sm notActive" data-toggle="utilities" data-title="Y">Yes</a>
                                            </div>
                                            {{form.utilities_included(class='form-control', required='required')}}
                                            <!-- <input type="hidden" name="utilities_included" id="utilities_included"> -->
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="furnished_label">Is the property furnished?</label>
                                        <div class="input-group">
                                            <div id="radioBtn" class="btn-group">
                                                <a class="btn btn-primary btn-sm active" data-toggle="furnished" data-title="N">No</a>
                                                <a class="btn btn-primary btn-sm notActive" data-toggle="furnished" data-title="Y">Yes</a>
                                            </div>
                                            {{form.furnished(class='form-control', required='required')}}
                                            <!-- <input type="hidden" name="furnished" id="furnished"> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-4">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Number of Bedrooms</label>
                                        {{form.num_bedrooms(class='form-control', required='required', maxlength='1')}}
                                        <!-- <input id="num_bedrooms" maxlength="1" type="number" required="required" class="form-control" /> -->
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Number of Full Bathrooms</label>
                                        {{form.num_full_baths(class='form-control', required='required', maxlength='1')}}
                                        <!-- <input id="num_full_baths" maxlength="1" type="number" required="required" class="form-control" /> -->
                                    </div>
                                </div>
                                <div class="col-xs-4">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback">Number of Half Bathrooms</label>
                                        {{form.num_half_baths(class='form-control', required='required', maxlength='1')}}
                                        <!-- <input id="num_half_baths" maxlength="1" type="number" required="required" class="form-control" /> -->
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-4">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3> Step 4: Appliances</h3>
                            <br>
                            <p><strong>Please select all that are included in the property</strong></p>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="ac_label">Air Conditioning</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.air_conditioning(class='form-control', required='required')}}
                                                <!-- <input id="air_conditioning" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="washer_label">Washing Machine</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.washer(class='form-control', required='required')}}
                                                <!-- <input id="washer" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="dryer_label">Dryer</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.dryer(class='form-check-input', required='required')}}
                                                <!-- <input id="dryer" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="dishwasher_label">Dishwasher</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.dishwasher(class='form-control', required='required')}}
                                                <!-- <input id="dishwasher" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-5">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3> Step 5: Services</h3>
                            <br>
                            <p><strong>Please select all that apply</strong></p>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="handicap_label">Is the Property Handicap Accessible?</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.handicap(class='form-control', required='required')}}
                                                <!-- <input id="handicap" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="snow_label">Do You Provide Snow Removal?</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.snow_plowing(class='form-control', required='required')}}
                                                <!-- <input id="snow_plowing" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="garbage_label">Are Garbage Services Included?</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.garbage_service(class='form-control', required='required')}}
                                                <!-- <input id="garbage_service" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="maintenance_label">Do You Offer Emergency Maintenance?</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.emergency_maintenance(class='form-control', required='required')}}
                                                <!-- <input id="maintenance" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="form-group">
                                        <label class="control-label form-control-feedback" id="security_label">Do You Offer Security Services?</label>
                                        <div class="checkbox">
                                            <label style="font-size: 1.5em">
                                                {{form.security_service(class='form-control', required='required')}}
                                                <!-- <input id="security" class="form-check-input" type="checkbox"> -->
                                                <span class="cr"><i class="cr-icon fa fa-check-circle"></i></span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-6">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3>Step 6: Description</h3>
                            <br>
                            <p><strong>If you would like to, provide a description of the property</strong></p>
                            <div class="form-group">
                                <label class="control-label form-control-feedback">Description</label>
                                {{form.description(class='form-control', rows='5')}}
                                <!-- textarea id="description" type="textarea" rows="5" class="form-control"></textarea> -->
                            </div>
                            <button class="btn btn-primary nextBtn btn-lg pull-right" type="button">Next</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row setup-content" id="step-7">
                <div class="col-xs-12">
                    <div class="row">
                        <div class="col-md-2"></div>
                        <div class="col-xs-12 col-md-8">
                            <h3>Step 7: Photos</h3>
                            <br>
                            <p><strong>Photos</strong></p>
                            <div class="form-group">
                                <label class="control-label form-control-feedback">Description</label>
                                {{form.pictures(class='form-control', multiple='')}}
                            </div>
                            <button onclick="submitListingForm()" class="btn btn-primary btn-lg pull-right" type="button">Create Listing</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>







{% endblock %} {% block scripts %}
<script>
$(document).ready(function() {
    /* Here we go, populate hidden form object with values to submit */
    $('#rent_due').change(function() {
        if ($("#rent_due").val() == "monthly") {
            $("#price_label").text("Price Per Bedroom per Month");
        } else {
            $("#price_label").text("Price Per Bedroom per Semester");
        }
    });

    $('#property_type').change(function() {
        if ($("#property_type").val() == "apartment") {
            $("#apartmentNumberInput").show();
            $('#apartment_number').attr('required', 'required');
        } else {
            $("#apartmentNumberInput").hide();
            $('#apartment_number').removeAttr('required');
        }
    });
    var navListItems = $('div.setup-panel div a'),
        allWells = $('.setup-content'),
        allNextBtn = $('.nextBtn'),
        zipCodeButton = $('#zipCodeButton');

    allWells.hide();

    navListItems.click(function(e) {
        e.preventDefault();
        var $target = $($(this).attr('href')),
            $item = $(this);

        if (!$item.hasClass('disabled')) {
            navListItems.removeClass('btn-primary').addClass('btn-default');
            $item.addClass('btn-primary');
            allWells.hide();
            $target.show();
            $target.find('input:eq(0)').focus();
        }
    });

    allNextBtn.click(function() {
        var curStep = $(this).closest(".setup-content"),
            curStepBtn = curStep.attr("id"),
            nextStepWizard = $('div.setup-panel div a[href="#' + curStepBtn + '"]').parent().next().children("a"),
            curInputs = curStep.find("input[type='text'],input[type='url'],input[type='date'],input[type='number']"),
            isValid = true;

        $(".form-group").removeClass("has-danger");
        $(".form-group").removeClass("has-error");
        for (var i = 0; i < curInputs.length; i++) {
            if (!curInputs[i].validity.valid) {
            	alert(curInputs[i].id);
                isValid = false;
                $(curInputs[i]).closest(".form-group").addClass("has-error");
                $(curInputs[i]).closest(".form-group").addClass("has-danger");
            }
        }

        if (isValid) {
            if ($(this).attr('id') == 'zipCodeButton') {
                var zipCodeValue = $("#zip_code").val();
                var isValidZip = /(^\d{5}$)|(^\d{5}-\d{4}$)/.test(zipCodeValue);
                if (isValidZip) {
                    nextStepWizard.removeClass('disabled').trigger('click');
                } else {
                    $("#zip_code").closest(".form-group").addClass("has-error");
                    $("#zip_code").closest(".form-group").addClass("has-danger");

                }
            }
            else{
            	nextStepWizard.removeClass('disabled').trigger('click');
            }
        }
    });

    $('div.setup-panel div a.btn-primary').trigger('click');
});
$('#radioBtn a').on('click', function() {
    var sel = $(this).data('title');
    var tog = $(this).data('toggle');
    $('#' + tog).prop('value', sel);

    $('a[data-toggle="' + tog + '"]').not('[data-title="' + sel + '"]').removeClass('active').addClass('notActive');
    $('a[data-toggle="' + tog + '"][data-title="' + sel + '"]').removeClass('notActive').addClass('active');
});

$(document).ready(function() {
        flatpickr(".flatpickr", {
        	wrap: true,
        	disable: [{from: "0001-01-01",
        			  to: "today"}]
        });
        $('.flatpickr-calendar').css('z-index', 99999999999999);
});

$(document).on("focusin", "#leaseStartDateInput", function() {
   $(this).prop('readonly', true);  
});

$(document).on("focusout", "#leaseStartDateInput", function() {
   $(this).prop('readonly', false); 
});

$(document).on("focusin", "#endLeaseDateInput", function() {
   $(this).prop('readonly', true);  
});

$(document).on("focusout", "#endLeaseDateInput", function() {
   $(this).prop('readonly', false); 
});

function submitListingForm() {
    alert('hey');
    $("form#createListingForm").submit();
}



</script>
{% endblock %}
